<style>
  input,
  nb-select {
    width: 80% !important;
  }

  input[readonly] {
    background-color: #afadad;
    color: #fff;
    cursor: not-allowed;
  }

  :host ::ng-deep span {
    /* right: 0 !important; */
    cursor: pointer !important;
  }
</style>

<div class="row">
  <div class="col-lg-12 col-md-12 col-sm-12">
    <form (ngSubmit)="onSubmit()" [formGroup]="recordMapInfoFormg">
      <input type="hidden" formControlName="className" />
      <nb-card>
        <nb-card-header *ngIf="responseType !== 'ReRegisterUnitMapChanges'">اطلاعات تکمیلی درخواست گاز</nb-card-header>
        <nb-card-header *ngIf="responseType === 'ReRegisterUnitMapChanges'">ثبت مجدد تغییرات نقشه لوله کشی
        </nb-card-header>
        <nb-card-body>
          <nb-card>
            <nb-card-body>
              <!-- <nb-card>
                <nb-card-body> -->
              <div class="col-lg-12 col-md-12 col-sm-12 mb-2">
                <div class="input-group">
                  <div class="col-lg-2 col-md-2 col-sm-2 ">
                    <label for="floorNumber">شماره طبقه</label>
                    <input class="d-block" formControlName="floorNumber" fullWidth id="floorNumber" nbInput min="0"
                      [readOnly]="
                            responseType == 'MapRevisionResultInspectionPreExecution' ||
                            responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                            responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                            responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                            responseType == 'MapRevisionResultInspectionFinal' ||
                            responseType == 'ReMapRevisionResultInspectionFinal' ||
                            responseType == 'ReRegisterUnitMapChanges'
                          " />
                    <div *ngFor="
                            let validation of INPUT_VALIDATION_MESSAGES.floorNumber
                          ">
                      <span class="text-danger" *ngIf="
                              recordMapInfoFormg
                                .get('floorNumber')
                                .hasError(validation.type) &&
                              (recordMapInfoFormg.get('floorNumber').dirty ||
                                recordMapInfoFormg.get('floorNumber').touched)
                            ">{{ validation.message }}</span>
                    </div>
                  </div>

                  <div class="col-lg-2 col-md-2 col-sm-2 ">
                    <label for="unitNumber">شماره واحد</label>
                    <input formControlName="unitNumber" fullWidth id="unitNumber" nbInput min="0" [readOnly]="
                          responseType == 'MapRevisionResultInspectionPreExecution' ||
                          responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                          responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'MapRevisionResultInspectionFinal' ||
                          responseType == 'ReMapRevisionResultInspectionFinal' ||
                          responseType == 'ReRegisterUnitMapChanges'
                          " />
                    <div *ngFor="
                            let validation of INPUT_VALIDATION_MESSAGES.unitNumber
                          ">
                      <span class="text-danger" *ngIf="
                              recordMapInfoFormg
                                .get('unitNumber')
                                .hasError(validation.type) &&
                              (recordMapInfoFormg.get('unitNumber').dirty ||
                                recordMapInfoFormg.get('unitNumber').touched)
                            ">{{ validation.message }}</span>
                    </div>
                  </div>

                  <div class="col-lg-4 col-md-4 col-sm-4" *ngIf="
                          !(responseType == 'MapRevisionResultInspectionPreExecution' ||
                            responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                            responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                            responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                            responseType == 'MapRevisionResultInspectionFinal' ||
                            responseType == 'ReMapRevisionResultInspectionFinal' ||
                            responseType == 'ReRegisterUnitMapChanges'
                            )">
                    <label class="d-block" for="direction">جهت</label>

                    <nb-select formControlName="direction" id="direction" placeholder="انتخاب جهت">
                      <nb-option value="0">
                        شمال
                      </nb-option>
                      <nb-option value="1">
                        جنوب
                      </nb-option>
                      <nb-option value="2">
                        شرق
                      </nb-option>
                      <nb-option value="3">
                        غرب
                      </nb-option>
                      <nb-option value="4">
                        شمال غربی
                      </nb-option>
                      <nb-option value="5">
                        شمال شرقی
                      </nb-option>
                      <nb-option value="6">
                        جنوب غربی
                      </nb-option>
                      <nb-option value="7">
                        جنوب شرقی
                      </nb-option>
                    </nb-select>

                    <!-- <div *ngIf="isSubmitted"> -->
                    <div *ngFor="
                            let validation of INPUT_VALIDATION_MESSAGES.direction
                          ">
                      <span class="text-danger" *ngIf="
                              recordMapInfoFormg.get('direction').value ===
                                '' && isSubmitted
                            ">{{ validation.message }}</span>
                    </div>
                    <!-- </div> -->
                  </div>

                  <div class="col-lg-4 col-md-4 col-sm-4 " *ngIf="
                        responseType == 'MapRevisionResultInspectionPreExecution' ||
                        responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                        responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                        responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                        responseType == 'MapRevisionResultInspectionFinal' ||
                        responseType == 'ReMapRevisionResultInspectionFinal' ||
                        responseType == 'ReRegisterUnitMapChanges'
                        ">
                    <label class="d-block">جهت</label>
                    <input [value]="direction" fullWidth nbInput style="margin-bottom: 45px;" [readOnly]="
                          responseType == 'MapRevisionResultInspectionPreExecution' ||
                          responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                          responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'MapRevisionResultInspectionFinal' ||
                          responseType == 'ReMapRevisionResultInspectionFinal' ||
                          responseType == 'ReRegisterUnitMapChanges'
                          " />
                  </div>

                  <div class="col-lg-4 col-md-4 col-sm-4" *ngIf="
                          !(
                            responseType == 'MapRevisionResultInspectionPreExecution' ||
                            responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                            responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                            responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                            responseType == 'MapRevisionResultInspectionFinal' ||
                            responseType == 'ReMapRevisionResultInspectionFinal'
                          )
                        ">
                    <label for="pipingKind">نوع لوله کشی</label>

                    <nb-select formControlName="pipingKind" id="pipingKind" placeholder="انتخاب نوع لوله کشی">
                      <nb-option value="0">
                        روکار
                      </nb-option>
                      <nb-option value="1">
                        زیرکار
                      </nb-option>
                    </nb-select>

                    <!-- <div *ngIf="isSubmitted"> -->
                    <div *ngFor="
                            let validation of INPUT_VALIDATION_MESSAGES.pipingKind
                          ">
                      <span class="text-danger" *ngIf="
                              recordMapInfoFormg.get('pipingKind').value ===
                                '' && isSubmitted
                            ">{{ validation.message }}</span>
                    </div>
                    <!-- </div> -->
                  </div>

                  <div class="col-lg-4 col-md-4 col-sm-4 " *ngIf="
                        responseType == 'MapRevisionResultInspectionPreExecution' ||
                        responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                        responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                        responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                        responseType == 'MapRevisionResultInspectionFinal' ||
                        responseType == 'ReMapRevisionResultInspectionFinal'
                        ">
                    <label for="pipingKindEdit">نوع لوله کشی</label>
                    <input [value]="pipingKind" fullWidth id="pipingKindEdit" nbInput style="margin-bottom: 45px;"
                      min="0" [readOnly]="
                          responseType == 'MapRevisionResultInspectionPreExecution' ||
                          responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                          responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'MapRevisionResultInspectionFinal' ||
                          responseType == 'ReMapRevisionResultInspectionFinal'
                          " />
                    <!-- <input

                          fullWidth
                          nbInput
                          id="pipingKindEdit"
                         class="mb-4"

                        /> -->
                  </div>
                </div>
              </div>

              <div class="col-lg-12 col-md-12 col-sm-12 mb-5">
                <div class="input-group">
                  <div class="col-lg-4 col-md-4 col-sm-4 ">
                    <label class="d-block" for="utilization">مصرف</label>
                    <input formControlName="utilization" fullWidth style="width: 91% !important" id="utilization"
                      nbInput type="number" min="0.1" max="160" (blur)="getMeterKind()" [readOnly]="
                          responseType == 'MapRevisionResultInspectionPreExecution' ||
                          responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                          responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'MapRevisionResultInspectionFinal' ||
                          responseType == 'ReMapRevisionResultInspectionFinal'
                          " />
                    <div *ngFor="
                            let validation of INPUT_VALIDATION_MESSAGES.utilization
                          ">
                      <span class="text-danger" *ngIf="
                              recordMapInfoFormg
                                .get('utilization')
                                .hasError(validation.type) &&
                              (recordMapInfoFormg.get('utilization').dirty ||
                                recordMapInfoFormg.get('utilization').touched)
                            ">{{ validation.message }}</span>
                    </div>
                  </div>

                  <!-- <div class="col-lg-2 col-md-2 col-sm-2 ">
                        <label for="collectorCount">تعداد کلکتور</label>
                        <input
                          formControlName="collectorCount"
                          fullWidth
                          id="collectorCount"
                          nbInput
                          min="0"
                          [readOnly]="
                          responseType == 'MapRevisionResultInspectionPreExecution' ||
                          responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                          responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'MapRevisionResultInspectionFinal' ||
                          responseType == 'ReMapRevisionResultInspectionFinal'
                          "
                        />
                        <div
                          *ngFor="
                            let validation of INPUT_VALIDATION_MESSAGES.collectorCount
                          "
                        >
                          <span
                            class="text-danger"
                            *ngIf="
                              recordMapInfoFormg
                                .get('collectorCount')
                                .hasError(validation.type) &&
                              (recordMapInfoFormg.get('collectorCount').dirty ||
                                recordMapInfoFormg.get('collectorCount').touched)
                            "
                            >{{ validation.message }}</span
                          >
                        </div>
                      </div> -->

                  <div class="col-lg-4 col-md-4 col-sm-4 ">
                    <label class="d-block" for="fondation">زیربنا</label>
                    <input formControlName="fondation" id="fondation" nbInput type="number" min="0" max="5000"
                      (blur)="getMeterKind()" [readOnly]="
                          responseType == 'MapRevisionResultInspectionPreExecution' ||
                          responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                          responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'MapRevisionResultInspectionFinal' ||
                          responseType == 'ReMapRevisionResultInspectionFinal'
                          " />

                    <div *ngFor="
                            let validation of INPUT_VALIDATION_MESSAGES.fondation
                          ">
                      <span class="text-danger" *ngIf="
                              recordMapInfoFormg
                                .get('fondation')
                                .hasError(validation.type) &&
                              (recordMapInfoFormg.get('fondation').dirty ||
                                recordMapInfoFormg.get('fondation').touched)
                            ">{{ validation.message }}</span>
                    </div>
                  </div>

                  <div class="col-lg-4 col-md-4 col-sm-4 ">
                    <label for="applianceCount">تعداد وسیله گازسوز</label>
                    <input formControlName="applianceCount" fullWidth id="applianceCount" nbInput type="number" min="0"
                      [readOnly]="
                          responseType == 'MapRevisionResultInspectionPreExecution' ||
                          responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                          responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'MapRevisionResultInspectionFinal' ||
                          responseType == 'ReMapRevisionResultInspectionFinal'
                          " />

                    <div *ngFor="
                            let validation of INPUT_VALIDATION_MESSAGES.applianceCount
                          ">
                      <span class="text-danger" *ngIf="
                              recordMapInfoFormg
                                .get('applianceCount')
                                .hasError(validation.type) &&
                              (recordMapInfoFormg.get('applianceCount').dirty ||
                                recordMapInfoFormg.get('applianceCount')
                                  .touched)
                            ">{{ validation.message }}</span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-lg-12 col-md-12 col-sm-12 mb-4">
                <div class="input-group">
                  <div class="col-lg-12 col-md-12 col-sm-12">
                    <label>نوع کنتور</label>
                    <nb-radio-group disabled #rdbMeterType class="form-inline radio-x-inline"
                      formControlName="baseMeterTypeId" id="meterKind" name="meterKind" style="margin-top: 0.6rem;"
                      [disabled]="
                          responseType == 'MapRevisionResultInspectionPreExecution' ||
                          responseType == 'ReMapRevisionResultInspectionPreExecution' ||
                          responseType == 'MapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'ReMapRevisionResultInspectionOfTheFirstStage' ||
                          responseType == 'MapRevisionResultInspectionFinal' ||
                          responseType == 'ReMapRevisionResultInspectionFinal' ||
                          responseType == 'ReRegisterUnitMapChanges'
                          ">
                      <nb-radio *ngFor="let bt of listMeterKinds" [value]="bt.id">
                        {{ bt.title }}
                      </nb-radio>
                    </nb-radio-group>

                    <div *ngIf="isSubmitted">
                      <div *ngFor="
                              let validation of INPUT_VALIDATION_MESSAGES.baseMeterTypeId
                            ">
                        <span class="text-danger" *ngIf="
                                recordMapInfoFormg.get('baseMeterTypeId')
                                  .value === ''
                              ">{{ validation.message }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-lg-12 col-md-12 col-sm-12 mb-4">
                <div class="row mb-3">
                  <div class="col-sm-2 mt-2 text-center">
                    <label for="baseSubscriptionTypeId">
                      <span class="text-danger font-weight-bold">*</span>

                      نوع اشتراک</label>
                  </div>
                  <div class="col-sm-10">
                    <nb-radio-group #rdbBuildingKind class="form-inline radio-x-inline"
                      formControlName="subscriptionType" id="subscriptionType" name="subscriptionType"
                      style="margin-top: 1.61rem">
                      <nb-radio value="1">خانگی</nb-radio>
                      <nb-radio value="2">عمومی</nb-radio>
                      <nb-radio value="3">صنعتی</nb-radio>

                    </nb-radio-group>

                    <div *ngIf="isSubmitted">
                      <div *ngFor="
                              let validation of INPUT_VALIDATION_MESSAGES.baseSubscriptionTypeId
                            ">
                        <span class="text-danger" *ngIf="
                              recordMapInfoFormg.controls.baseSubscriptionTypeId.value === '' &&
                                isSubmitted
                              ">{{ validation.message }}</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>

              <div class="col-lg-12 col-md-12 col-sm-12 mb-4">
                <div class="row mb-3">
                  <div class="col-sm-2 mt-2 text-center">
                    <label>
                      <span class="text-danger font-weight-bold">*</span>

                      نوع کاربری</label>
                  </div>
                  <div class="col-sm-10">
                    <nb-radio-group formControlName="buildingKind" id="buildingKind" name="buildingKind"
                      style="margin-top: 1.75rem">
                      <nb-radio value="0">مسکونی</nb-radio>
                      <nb-radio value="1">عمومی ( شامل : کسب و خدمات ،مراکز فرهنگی و آموزشی مذهبی درمانی ، اماکن و
                        تاسیسات دولتی ، ادارات و ارگانها و سازمان ها )
                      </nb-radio>
                      <nb-radio value="2">خاص</nb-radio>

                    </nb-radio-group>

                    <div *ngIf="isSubmitted">
                      <div *ngFor="
                              let validation of INPUT_VALIDATION_MESSAGES.buildingKind
                            ">
                        <span class="text-danger" *ngIf="
                              recordMapInfoFormg
                                  .get('buildingKind')
                                  .hasError(validation.type)
                              ">{{ validation.message }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>


              <div class="col-lg-12 col-md-12 col-sm-12 mb-5">
                <div class="input-group">
                  <div class="col-lg-12 col-md-12 col-sm-12">
                    <!-- <span class="text-danger font-weight-bold">*</span> -->
                    <label for="useTitle">عنوان کاربری</label>
                    <textarea formControlName="useTitle" fullWidth nbInput rows="5" shape="round"></textarea>
                  </div>
                </div>
              </div>

              <div class="input-group mb-5 mx-3" *ngIf="(isEditByEngineer=== false)">
                <div class="col-lg-12 col-md-12 col-sm-12">
                  <label for="file">نقشه لوله کشی:</label>

                  <div *ngFor="let a of inputCount; let i = index">
                    <strong class="mb-2" style="color: rgb(0, 68, 255); display:block; font-size: 11px;"> حداکثر حجم
                      {{sizeTitles[i]}} - فرمت ها ({{a.extentions}}) </strong>
                    <app-uploader [formControlName]="a.formControlName" [progress]="progress" [filePath]="imagePath"
                      [fileExtentions]="a.extentions" [fileSize]="a.size" [className]="responseType">
                    </app-uploader>
                  </div>
                </div>
              </div>


              <div class="col-lg-12 col-md-12 col-sm-12  mb-5" *ngIf="isEditByEngineer">
                <div class="input-group">
                  <div class="col-lg-12 col-md-12 col-sm-12">
                    <!-- <span class="text-danger font-weight-bold">*</span> -->
                    <label for="useTitle">مستندات :</label>
                    <span class="img-wrapper " style="padding: 0px 20px 0px 0px !important;"
                      *ngFor="let img of imagePath; let i = index">
                      <img class="imageSrc ml-3" style="
                              border: 1px solid black;
                              padding: 3px;
                              box-shadow: 0 0 10px;
                              position: relative;
                              top: -10px;
                              cursor: pointer;
                            " id="blah" [src]="img" alt="your image" width="70px" height="70px" />
                    </span>
                  </div>
                </div>
              </div>
              <div class="col-lg-12 col-md-12 col-sm-12">
                <div class="input-group">
                  <div class="col-lg-12 col-md-12 col-sm-12">
                    <label for="file">توضیحات و نظرات</label>
                    <textarea formControlName="description" fullWidth nbInput rows="5" shape="round"></textarea>
                  </div>
                </div>
              </div>

              <div class="btn-group col-lg-12 col-md-12 col-sm-12 mr-3 ml-5 pl-5" *ngIf="!isEdit">
                <button class="btn" nbButton status="success" style="width: 100%;" type="submit" [disabled]="
                          loading ||
                          !recordMapInfoFormg.valid ||
                          recordMapInfoFormg.get('baseMeterTypeId').value === '' ||
                          recordMapInfoFormg.get('pipingKind').value === '' ||
                          recordMapInfoFormg.get('buildingKind').value === '' ||
                          recordMapInfoFormg.get('subscriptionType').value === ''                        "
                  [nbSpinner]="loading" nbSpinnerStatus="info" nbSpinnerSize="large">
                  ثبت
                </button>
              </div>

              <div class="btn-group col-lg-6 col-md-6 col-sm-6 pl-3 pr-5" *ngIf="isEdit && !isControlFinal">
                <button class="btn" nbButton status="success" style="width: 100%;" type="submit" [disabled]="
                          loading ||
                          !recordMapInfoFormg.valid ||
                          recordMapInfoFormg.get('baseMeterTypeId').value === '' ||
                          recordMapInfoFormg.get('pipingKind').value === '' ||
                          recordMapInfoFormg.get('direction').value === ''||
                          recordMapInfoFormg.get('buildingKind').value === '' ||
                          recordMapInfoFormg.get('subscriptionType').value === ''
                        " [nbSpinner]="loading" nbSpinnerStatus="info" nbSpinnerSize="large">
                  ویرایش
                </button>
              </div>
              <div class="btn-group col-lg-6 col-md-6 col-sm-6 pl-5 pr-3" *ngIf="isEdit && !isControlFinal">
                <button class="btn" nbButton status="danger" style="width: 100%;" type="button" (click)="cancle()">
                  انصراف
                </button>
              </div>
              <!-- </nb-card-body>
              </nb-card> -->
            </nb-card-body>
          </nb-card>

        </nb-card-body>
      </nb-card>
    </form>
  </div>
</div>