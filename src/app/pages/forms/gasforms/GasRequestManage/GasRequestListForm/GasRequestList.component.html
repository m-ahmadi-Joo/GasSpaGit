<style>
  .pagination /deep/ .ngx-pagination .current {
    background: lightseagreen;
  }

  .pagination /deep/ pagination-template {
    width: 100% !important;
  }

  .pagination {
    text-align: center !important;
  }

  dp-date-picker /deep/ .dp-input-container .dp-picker-input {
    width: 220px !important;
    border-radius: 0.25rem;
    font-size: 0.9375rem;
    font-weight: 600;
    line-height: 1.5rem;
    padding: 0.4375rem 1.125rem;
    background-color: #f7f9fc;
    border-color: #edf1f7;
    border-style: solid;
    border-width: 1px;
    color: #1a2138;
    /* -webkit-appearance: none; */
    transition-duration: 0.15s;
    transition-property: border, background-color, color, box-shadow;
    transition-timing-function: ease-in;
    font-family: IRANSansWeb;
    overflow: visible;
  }

  dp-date-picker /deep/button.dp-calendar-nav-left::before {
    transform: rotate(52deg)!important;
  }
  dp-date-picker /deep/button.dp-calendar-nav-right::before {
    transform: rotate(224deg)!important;
  }
  dp-date-picker /deep/ .dp-nav-btns-container
  /* dp-calendar-nav /deep/ .dp-nav-btns-container */
  {
    direction: rtl!important;
  }
 
  nb-select.pageSizeSelect /deep/ .select-button {
    min-width: 8rem !important;
  }

  nb-select.workStatus /deep/ .select-button {
    /* width:100%;
          min-width: 19rem !important;
          max-width: 22rem !important; */
    padding: 0.3rem 1.125rem !important;
  }

  nb-accordion nb-accordion-item-body /deep/ .item-body {
    padding: 0 !important;
  }

  /* nb-accordion nb-accordion-item-body /deep/ .map-position {
    position: relative;
    top: 0;
    right: 0;
    text-decoration: none;
    display: inline-block;
    padding: 10px 0;
  } */

  .col-lg-3.col-md-3.col-sm-6.col-xs-12,
  .col-lg-2.col-md-2.col-sm-6.col-xs-12 {
    padding: 7px;
  }

  p {
    text-align: justify;
    text-justify: inter-word;
    line-height: 1.8;
    font-size: 1rem;
    /* margin: 0 20px 15px 20px; */
  }
</style>

<nb-card style="box-shadow: 0 0 4px">
  <nb-card-body>
    <nb-accordion multi>
      <!-- <nb-accordion-item expanded> -->
      <nb-accordion-item expanded>
        <nb-accordion-item-header *appHasNoRole="['Pishkhan']">
          جستجوی پیشرفته
        </nb-accordion-item-header>
        <nb-accordion-item-header *appHasRole="['Pishkhan']">
          جستجوی املاک
        </nb-accordion-item-header>
        <nb-accordion-item-body>
          <div class="container" id="serachCard">
            <form class="form-inline" (ngSubmit)="onSerach()" [formGroup]="form">
              <ul>
                <div *ngFor="
                    let validation of INPUT_VALIDATION_MESSAGES.renewerCode
                  ">
                  <li *ngIf="
                      form.get('renewerCode').hasError(validation.type) &&
                      (form.get('renewerCode').dirty ||
                        form.get('renewerCode').touched)
                    ">
                    <span class="text-danger"> {{ validation.message }}</span>
                  </li>
                </div>
                <div *ngFor="
                let validation of INPUT_VALIDATION_MESSAGES.registerYear
              ">
                  <li *ngIf="
                  form.get('registerYear').hasError(validation.type) &&
                  (form.get('registerYear').dirty ||
                    form.get('registerYear').touched)
                ">
                    <span class="text-danger"> {{ validation.message }}</span>
                  </li>
                </div>
                <li class="text-danger" *ngIf="
                    form.get('dateStart').value > form.get('dateEnd').value &&
                    form.get('dateEnd').value !== ''
                  ">
                  <span class="text-danger">تاریخ شروع ثبت می بایست کوچکتر از پایان ثبت باشد.</span>
                </li>
              </ul>

              <div class="row" *appHasNoRole="['Pishkhan']">
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                  <label class="align-right d-block mb-3" for="fileNumber">
                    <!-- style="margin-left: 0.45rem;" -->
                    شماره درخواست:
                  </label>

                  <!-- <div class="input-group"> -->
                  <div class="form-group">
                    <input formControlName="fileNumber" size="small" fullWidth id="fileNumber" nbInput type="number"
                      min="1000" />
                  </div>

                </div>

                <div class="form-group col-lg-3 col-md-3 col-sm-6 col-xs-12">
                  <label for="workStatus"> زمان ثبت از: </label> 
                  <dp-date-picker [disabled]="disableStartDate" name="ds" placeHolder="زمان ثبت شروع" id="ds" nbInput
                    dir="rtl" mode="day" theme="dp-material" formControlName="dateStart" [config]="datePickerConfig"
                    (open)="openStartDayPicker()" (close)="closeStartDayPicker()" nbInput></dp-date-picker> 
                </div>

                <div class="form-group col-lg-3 col-md-3 col-sm-6 col-xs-12">
                  <label for="workStatus"> زمان ثبت تا: </label>


                  <dp-date-picker [disabled]="disableEndDate" name="de" placeHolder="زمان ثبت پایان" id="de" nbInput
                    dir="rtl" mode="day" theme="dp-material" formControlName="dateEnd" [config]="datePickerConfig"
                    (open)="openEndDayPicker()" (close)="closeEndDayPicker()" nbInput></dp-date-picker>

                </div>

                <div class="form-group col-lg-3 col-md-3 col-sm-6 col-xs-12">
                  <label for="workStatus"> سال ثبت: </label>

                  <input formControlName="registerYear" nbInput dir="rtl" fullWidth id="reportYear" type="text"
                    placeholder="1400" (change)="onChangeRegisterYear($event)" />

                </div>

              </div>

              <div class="row">
                <!--<div class="form-group mt-3 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                  <label class="align-right d-block mb-3" for="workStatus">
                   style="margin-left: 0.45rem;" 
                    وضعیت ها:
                  </label>-->

                <!-- <div class="input-group"> -->
                <!--<div class="form-group">
                    <nb-select class="workStatus" multiple #workStates formControlName="workStates" status="info"
                      id="workStates" placeholder="انتخاب وضعیت ها..." size="small">
                      <nb-option [value]="null">هیچ کدام</nb-option>
                      <nb-option *ngFor="let p of workStatuses" [value]="p.className">
                        {{ p.title }}
                      </nb-option>
                    </nb-select>
                  </div>

                </div>-->
                <div class="form-group mt-3 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                  <label for="workStates">
                    وضعیت ها:
                  </label>

                  <nb-select class="" multiple #workStates formControlName="workStates" status="info" id="workStates"
                    placeholder="انتخاب وضعیت ها..." fullWidth>
                    <nb-option [value]="null">هیچ کدام</nb-option>
                    <nb-option *ngFor="let p of workStatuses" [value]="p.className">
                      {{ p.title }}
                    </nb-option>
                  </nb-select>
                </div>


                <div class="form-group mt-3 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                  <label for="areas"> در انتظار بررسی: </label>

                  <nb-select multiple #waitingStates formControlName="waitingStates"
                    placeholder="انتخاب در انتظار بررسی" fullWidth id="waitingStates" status="info">
                    <nb-option [value]="null">هیچ کدام</nb-option>
                    <nb-option *ngFor="let w of waitingStatuses" [value]="w.className">
                      {{ w.title }}
                    </nb-option>
                  </nb-select>
                </div>

                <div class="form-group mt-3 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                  <label for="areas"> منطقه گازی: </label>

                  <nb-select (selectedChange)="onAreaChange(areasSelect.selected)" multiple [selected]="
                      filterParams?.areas?.length > 0
                        ? filterParams?.areas
                        : emptyArray
                    " #areasSelect placeholder="انتخاب ناحیه" fullWidth id="areas" formControlName="areas">
                    <nb-option [value]="null">هیچ کدام</nb-option>
                    <nb-option *ngFor="let area of areas" [value]="area.id">
                      {{ area.title }}
                    </nb-option>
                  </nb-select>
                </div>

                <div class="form-group mt-3 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                  <label for="village"> شهر/روستا:</label>

                  <nb-select multiple [selected]="
                      filterParams?.towns?.length > 0
                        ? filterParams?.towns
                        : emptyArray
                    " #townSelect placeholder="انتخاب شهر - روستا" fullWidth id="village" formControlName="towns">
                    <nb-option [value]="null">هیچ کدام</nb-option>
                    <nb-option *ngFor="let tw of towns" [value]="tw.townId">
                      {{ tw.townName }}
                    </nb-option>
                  </nb-select>
                </div>
              </div>

              <div class="row" *appHasNoRole="['Pishkhan']">
                <div class="form-group col-lg-3 col-md-3 col-sm-6 col-xs-12 mt-3" style="padding-right: 15px">
                  <label for="renewerCode" class="pb-0"> کد نوسازی: </label>
                  <!-- <div class="input-group"> -->
                  <input formControlName="renewerCode" size="small" fullWidth id="renewerCode"
                    placeholder="مثال: 1-2-3-4-5-6-7" nbInput type="text" />
                </div>

                <div *appHasNoRole="['Owner']" class="form-group mt-3 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                  <label for="fileNumber"> کد ملی مالک: </label>

                  <!-- <div class="input-group"> -->
                  <input formControlName="nationalCode" size="small" fullWidth id="nationalCode" nbInput type="text" />
                  <!-- <div class="inut-group-append">
                                      <button nbTooltip="پاک کردن" nbTooltipPlacement="top" style="height: 35px" size="tiny" nbButton outline status="info" type="button" (click)="resetFileNumber()">
                                          <nb-icon
                                          [options]="{ animation: { type: 'pulse' } }"
                                          class="icon-button"
                                          icon="trash-outline">
                                        </nb-icon>
                                      </button>
                                  </div> -->
                  <!-- </div> -->
                </div>
                <div *appHasNoRole="['Owner']" class="form-group col-lg-3 col-md-3 col-sm-6 col-xs-12 mt-3">
                  <label for="ownerName"> نام مالک: </label>

                  <!-- <div class="input-group"> -->
                  <input formControlName="ownerName" size="small" fullWidth id="ownerName" nbInput type="text" />
                  <!-- <div class="input-group-append">
                                        <button nbTooltip="پاک کردن" nbTooltipPlacement="top" size="tiny" nbButton outline status="info" type="button" (click)="resetOwnerName()">
                                            <nb-icon
                                            [options]="{ animation: { type: 'pulse' } }"
                                            class="icon-button"
                                            icon="trash-outline">
                                          </nb-icon>
                                        </button>
                                    </div> -->
                  <!-- </div> -->
                </div>
                <div *appHasNoRole="['Executor']" class="form-group col-lg-3 col-md-3 col-sm-6 col-xs-12 mt-3">
                  <label for="executerName"> نام مجری: </label>

                  <!-- <div class="input-group"> -->
                  <input formControlName="executerName" size="small" fullWidth id="executerName" nbInput type="text" />
                  <!-- <div class="input-group-append">
                                      <button nbTooltip="پاک کردن" nbTooltipPlacement="top" size="tiny" nbButton outline status="info" type="button" (click)="resetOwnerName()">
                                          <nb-icon
                                          [options]="{ animation: { type: 'pulse' } }"
                                          class="icon-button"
                                          icon="trash-outline">
                                        </nb-icon>
                                      </button>
                                  </div> -->
                  <!-- </div> -->
                </div>
                <!-- <div class="form-group mt-3 col-lg-2 col-md-2 col-sm-6 col-xs-12" style="padding-left: 15px">
                  <label for="fileNumber">
                    شماره درخواست:
                  </label>

                  <input formControlName="fileNumber" size="small" fullWidth id="fileNumber" nbInput type="number"
                    min="1000" />
                </div> -->


              </div>

              <div class="form-group col-lg-2 col-md-2 col-sm-6 col-xs-12 float-right pr-0 mr-3 p-0">
                <button nbTooltip="جستجو" nbTooltipPlacement="top" nbButton hero size="tiny" status="info" type="submit"
                  class="ml-1" style="height: 45%">
                  <nb-icon [options]="{ animation: { type: 'pulse' } }" class="icon-button" icon="search-outline">
                  </nb-icon>
                </button>

                <button nbTooltip="بازسازی" nbTooltipPlacement="top" size="tiny" nbButton hero status="primary"
                  type="button" (click)="resetFilters()" style=" height: 45%">
                  <nb-icon [options]="{ animation: { type: 'pulse' } }" class="icon-button" icon="refresh-outline">
                  </nb-icon>
                </button>
              </div>



              <div class="row" *appHasRole="['Pishkhan']">
                <div class="form-group mt-3 col-lg-6 col-md-6 col-sm-6 col-xs-12">
                  <label for="fileNumber"> کد ملی مالک: </label>

                  <!-- <div class="input-group"> -->
                  <input formControlName="nationalCode" size="small" fullWidth id="nationalCode" nbInput type="text" />
                  <!-- <div class="inut-group-append">
                                      <button nbTooltip="پاک کردن" nbTooltipPlacement="top" style="height: 35px" size="tiny" nbButton outline status="info" type="button" (click)="resetFileNumber()">
                                          <nb-icon
                                          [options]="{ animation: { type: 'pulse' } }"
                                          class="icon-button"
                                          icon="trash-outline">
                                        </nb-icon>
                                      </button>
                                  </div> -->
                  <!-- </div> -->
                </div>

                <div class="col-sm-3 pr-1">
                  <button nbTooltip="جستجو" nbTooltipPlacement="top" nbButton hero size="tiny" status="info"
                    type="submit" class="ml-1" style="margin-top: 45px">
                    <nb-icon [options]="{ animation: { type: 'pulse' } }" class="icon-button" icon="search-outline">
                    </nb-icon>
                  </button>
                </div>
              </div>
              <!-- <div class="col">
                  <div class="btn-group float-right">
                                <button type="button" name="orderBy" class="btn btn-primary"
                                  [(ngModel)]="filterParams.orderBy" (click)="loadList()" btnRadio="lastActive">Last Active</button>
                                <button type="button" name="orderBy" class="btn btn-primary"
                                  [(ngModel)]="filterParams.orderBy" (click)="loadList()" btnRadio="created">Newest Members</button>
                              </div>
                            </div> -->
            </form>
            <br />

            <!-- <div class="input-group form-inline">
                              <div class="input-group col-md-6">
                                <input #search class="search" type="text" placeholder="جستجو..." (keydown.enter)="onSearch(search.value)">
                              </div>
                          </div> -->

            <!-- <form class="form-inline" #form="ngForm" (ngSubmit)="loadList()" novalidate>
                            <div class="form-group">
                              <label for="minAge">Age From</label>
                              <input type="number" class="form-control ml-1" style="width: 70px" id="minAge"
                                [(ngModel)]="filterParams.minAge" name="minAge">
                            </div>

                            <div class="form-group px-2">
                              <label for="maxAge">Age To</label>
                              <input type="number" class="form-control ml-1" style="width: 70px" id="maxAge"
                                 [(ngModel)]="filterParams.maxAge" name="maxAge">
                            </div>

                            <div class="form-group px-2">
                              <label for="gender">Show: </label>
                              <select class="form-control ml-1" style="width: 130px" id="gender"
                                [(ngModel)]="filterParams.gender" name="gender">
                                <option *ngFor="let gender of genderList" [value]="gender.value">
                                  {{gender.display}}
                                </option>
                              </select>
                            </div>
                            <button type="submit" class="btn btn-primary" style="margin-left:10px">Apply Filters</button>
                            <button type="button" class="btn btn-info" (click)="resetFilters()" style="margin-left:10px">
                                Reset Filter
                            </button>
                            <div class="col">
                              <div class="btn-group float-right">
                                <button type="button" name="orderBy" class="btn btn-primary"
                                  [(ngModel)]="filterParams.orderBy" (click)="loadList()" btnRadio="lastActive">Last Active</button>
                                <button type="button" name="orderBy" class="btn btn-primary"
                                  [(ngModel)]="filterParams.orderBy" (click)="loadList()" btnRadio="created">Newest Members</button>
                              </div>
                            </div>

                        </form>
                        <br>
                     -->
          </div>
        </nb-accordion-item-body>
      </nb-accordion-item>
      <!-- 
      <nb-accordion-item>
        <nb-accordion-item-header> مشاهده نقشه </nb-accordion-item-header>
        <nb-accordion-item-body>
          <strong class="mb-0">
            برای نمایش نقشه در سایز بزرگ از
            <img style="display: inline-block; width: 34px; height: 34px" src="assets/images/icon-fullscreen-2x.png" />
            در نقشه استفاده نمایید
          </strong>
          <div style="height: 300px" leaflet [leafletOptions]="options" [leafletLayers]="layers"></div>
        </nb-accordion-item-body>
      </nb-accordion-item> -->
    </nb-accordion>
  </nb-card-body>
</nb-card>

<nb-card class="table-x-mine" style="box-shadow: 0 0 4px">
  <nb-card-header class="pt-4" style="border-bottom: 0">
    <div class="pull-right pt-2">
      <span>کارتابل ورودی</span>
      <nb-icon [options]="{ animation: { type: 'pulse' } }" class="icon-button" icon="arrow-ios-back-outline">
      </nb-icon>

      <span class="mr-1" style="color: #3366ff">املاک</span>
    </div>
    <div class="row pull-left ml-1">
      <div class="alert alert-warning p-0 mt-2 ml-1" role="alert" *appHasRole="['Owner']">
        <p class="justify-content-center mb-0" style="padding: 2px">
          برای ثبت ملک جدید بر روی دکمه ثبت ملک کلیک نمایید.
        </p>
      </div>
      <div>
        <button nbButton status="primary" hero *appHasRole="['Owner']" [routerLink]="['/pages/forms/GasRequest']">
          <nb-icon [options]="{ animation: { type: 'pulse' } }" class="icon-button" icon="home-outline">
          </nb-icon>
          ثبت ملک
        </button>
      </div>

      <!-- <button
        [disabled]="!(selectedPay.length > 0)"
        [ngStyle]="{
          cursor: !(selectedPay.length > 0) ? 'not-allowed' : 'pointer'
        }"
        *appHasRole="['Owner', 'Admin', 'Executor']"
        class="btn btn-info ml-2"
        style="color:#fff"
        (click)="totalPay($event)"
      >
        <nb-icon
          [options]="{ animation: { type: 'pulse' } }"
          class="icon-button"
          icon="credit-card-outline"
        >
        </nb-icon>
        پرداخت جمعی
      </button> -->
      <!-- [disabled]="!(selectedPay.length > 0)" -->

      <!-- <button
        [ngStyle]="{
          cursor: !(collctiveDefineObserver.length > 0)
            ? 'not-allowed'
            : 'pointer'
        }"
        *appHasRole="['Admin', 'GasEmployee']"
        class="btn btn-info ml-2"
        style="color:#fff"
        (click)="totalObserver($event)"
        [disabled]="!(collctiveDefineObserver.length > 0)"
      >
        <nb-icon
          [options]="{ animation: { type: 'pulse' } }"
          class="icon-button"
          icon="credit-card-outline"
        >
        </nb-icon>
        تعیین ناظر جمعی
      </button> -->

      <button [ngStyle]="{
          cursor: !(collectiveControlDocumetns.length > 0)
            ? 'not-allowed'
            : 'pointer'
        }" *appHasRole="['Admin', 'GasEmployee','AnalyzeEmployee']" nbButton status="primary" hero (click)="totalControlDocument($event)"
        [disabled]="!(collectiveControlDocumetns.length > 0)">
        <nb-icon [options]="{ animation: { type: 'pulse' } }" class="icon-button" icon="credit-card-outline">
        </nb-icon>
        کنترل مدارک جمعی
      </button>
    </div>

    <div class="clearfix"></div>
  </nb-card-header>
  <!-- (userRowSelect)="pooriya($event)" -->
  <nb-card-body>
    <div style="clear: both"></div>
    <div class="table-wrapper">
      <ng2-smart-table [settings]="settings" [source]="source | paginate: pagingConfig" (custom)="onCustom($event)"
        style="direction: ltr"></ng2-smart-table>
    </div>
    <span *ngFor="let item of collection | paginate: pagingConfig"></span>

    <nb-card>
      <nb-card-body>
        <div class="row">
          <div class="input-group">
            <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6 form-inline pull-right">
              <label for="pageSize" style="margin-left: 0"> رکورد صفحه: </label>
              <nb-select status="info" #pageSizeSelect class="pageSizeSelect" [selected]="pagination.itemsPerPage"
                (selectedChange)="changePageSize(pageSizeSelect.selected)" id="pageSize" placeholder="انتخاب ...">
                <nb-option *ngFor="let p of pageSizes" [value]="p.id">
                  {{ p.display }}
                </nb-option>
              </nb-select>
            </div>

            <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12 mt-2">
              <div class="d-flex justify-content-center">
                <pagination-controls class="pagination" (pageChange)="pageChanged($event)" previousLabel=""
                  nextLabel="">
                </pagination-controls>
              </div>
            </div>
            <!-- <div
              class="col-lg-2 col-md-2 col-sm-6 col-xs-6 form-inline pull-left"
            >
              <label for="pageSize" style="margin-left: 0.45rem;">
                تعداد رکورد:{{ pagination.totalItems }}
              </label>
            </div> -->
            <div style="padding-right: 7% !important" class="col-lg-4 col-md-4 col-sm-6 col-xs-6 form-inline pull-left">
              <label for="pageNumber" style="margin-left: 0.45rem">
                صفحه:
              </label>
              <input [value]="pagination.currentPage" style="width: 30%" #pageNumber size="tiny" id="pageNumber" nbInput
                type="number" min="1" max="pagination.totalPages" (keydown.enter)="pageChanged(pageNumber.value)" />
              <span> از {{ pagination.totalItems }} نتیجه</span>
            </div>
          </div>
        </div>
      </nb-card-body>
    </nb-card>
  </nb-card-body>
</nb-card>

<ng-template #dialog let-data let-ref="dialogRef">
  <nb-card status="danger" accent="danger">
    <nb-card-header>
      <h4 style="color: linen">هشدار</h4>
    </nb-card-header>
    <nb-card-body>
      <h6>آیا از حذف مورد اطمینان دارید؟</h6>
    </nb-card-body>
    <nb-card-footer>
      <div class="row">
        <div class="col-sm-6">
          <button [disabled]="loadingDelete" [nbSpinner]="loadingDelete" nbSpinnerStatus="info" nbSpinnerSize="large"
            fullWidth nbButton hero status="danger" (click)="confirmDelete(data)">
            بلی
          </button>
        </div>
        <div class="col-sm-6">
          <button [disabled]="loadingDelete" fullWidth nbButton hero status="primary" (click)="rejectDelete(data)">
            انصراف
          </button>
        </div>
      </div>
    </nb-card-footer>
  </nb-card>
</ng-template>

<ng-template #dialogCollector let-data let-ref="dialogCollectorRef">
  <nb-card status="success" accent="success" style="max-width: 480px !important;">

    <nb-card-header>
      <h6 *ngIf="collectorCount == null" style="color: linen">ثبت کلکتور جوش</h6>
      <h6 *ngIf="collectorCount != null" style="color: linen">ویرایش کلکتور جوش</h6>
    </nb-card-header>
    <nb-card-body>
      <p class="mb-3" style="color: #f53259; font-size: 13px">
        توجه: مجری گرامی لطفاً در وارد کردن تعداد کلکتور جوش دقت نمایید هیچگاه تعداد
        کلکتور <span class="font-weight-bold">نمی تواند</span> برابر با تعداد
        واحد یک ملک باشد به طور مثال برای یک مجتمع 36 واحدی ممکن است تنها 1 (یک)
        کلکتور وجود داشته باشد.
      </p>
      <div>
        <nb-radio-group class="form-inline radio-x-inline w-100" [(ngModel)]="collectorType"
          (valueChange)="onChangeCollectorType($event,data)" id="collectorType" name="collectorType">
          <nb-radio value="1" aria-checked="true" style="cursor: pointer !important;">
            یک کلکتور
          </nb-radio>
          <nb-radio value="2" style="cursor: pointer !important;">
            بیش از یک کلکتور
          </nb-radio>
        </nb-radio-group>
      </div>

      <div class="form-group">
        <label for="collectorCount">تعداد کلکتور</label>
        <input min="0" type="number" max="{{ data.unitCount }}" class="form-control" id="collectorInput" [(ngModel)]="collectorCount"
          (change)="onChangeCollectorCount(collectorCount,data)" />
      </div>

      <div>
        <p class="mb-0" style="color: #f53259; font-size: 13px" *ngIf="showMultiCollector">
          در صورت عدم وجود کلکتور مقدار صفر را وارد نمایید.
        </p>
        <div class="form-row scrollable-container" *ngIf="showMultiCollector" style="height: 120px;">
          <div *ngFor="let collector of collectorCountArr; index as i;"
            class="form-group col-lg-6 col-md-6 col-sm-6 col-xs-12 mt-2" style="padding-right: 15px">

            <label for="unitSlcRadio{{ i+1 }}" style="cursor: pointer !important;" class="col-form-label pb-0 form-inline">جوش کلکتور {{ i+1 }} &nbsp;&nbsp;
              <input [value]="collector.checked" name="collectorRadio" type="radio" class="form-control form-inline" size="small"
               id="unitSlcRadio-{{ i+1 }}" 
              [(ngModel)]="collector.checked" (change)="selectUnitRadio(collector)" />
            </label>
           
            <nb-select class="" multiple [disabled]="collector.disabled"  #reqUnit [(ngModel)]="collector.selected" status="info" id="collectorSelected-{{ i+1 }}"
              placeholder="انتخاب واحد ها..." fullWidth
              aria-disabled="collector.disabled">
              <nb-option [value]="null">هیچ کدام</nb-option>
              <nb-option *ngFor="let p of multiUnitCollector" [value]="p.idx">
                {{ p.fileNumber }}
              </nb-option>
            </nb-select>
          </div>
        </div>
      </div>


      <p class="mb-0" style="color: #f53259; font-size: 13px" *ngIf="!showMultiCollector">
        در صورت عدم وجود کلکتور مقدار صفر را وارد نمایید.
      </p>


    </nb-card-body>
    <nb-card-footer>
      <div class="row">
        <div class="col-sm-6 pl-1">
          <button [nbSpinner]="collectorBtnLoading" [disabled]="collectorBtnLoading" nbSpinnerStatus="info"
            nbSpinnerSize="large" fullWidth nbButton hero status="success" (click)="collectorRegistrationConfirm(data)">
            <span *ngIf="data.collectorCount == null">ثبت</span>
            <span *ngIf="data.collectorCount != null">ویرایش</span>
          </button>
        </div>
        <div class="col-sm-6 pr-1">
          <!-- <button [disabled]="collectorBtnLoading" fullWidth nbButton hero status="danger"
            (click)="dialogCollectorRef.close()">
            انصراف
          </button> -->

          <button [disabled]="collectorBtnLoading" fullWidth nbButton hero status="danger"
            (click)="onClosedialogCollector()">
            انصراف
          </button>
        </div>
      </div>
    </nb-card-footer>
  </nb-card>
</ng-template>

<ng-template #endOrBlockRequest let-data let-ref="dialogEndOrBlockRef">
  <nb-card size="medium" status="danger" accent="danger">
    <nb-card-header>
      <h6 style="color: linen">
        غیر فعال سازی پرونده شماره {{ data.fileNumber }}
      </h6>
    </nb-card-header>
    <nb-card-body>
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12">
          <form [formGroup]="formEndOrBlockRequest" (ngSubmit)="endOrBlockRequestConfirm(data.entityId)">
            <nb-card>
              <nb-card-body>
                <div class="row">
                  <div class="col-sm-4 mt-2">
                    <span style="display: inline-block">
                      <span class="text-danger font-weight-bold">*</span>
                      نوع:
                    </span>
                  </div>

                  <div class="col-sm-8">
                    <nb-radio-group class="form-inline radio-x-inline" formControlName="closingType" id="closingType"
                      name="closingType">
                      >
                      <nb-radio value="1"> انسداد </nb-radio>
                      <nb-radio value="2"> اختتام </nb-radio>
                    </nb-radio-group>

                    <div *ngIf="isSubmitedEndOrBlockRequest">
                      <div *ngFor="
                          let validation of INPUT_VALIDATION_MESSAGES_EndOrBlockRequest.closingType
                        ">
                        <span class="text-danger" *ngIf="
                            formEndOrBlockRequest
                              .get('closingType')
                              .hasError(validation.type)
                          ">{{ validation.message }}</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row mt-2 mb-3 mb-0">
                  <div class="col-sm-4 mt-2">
                    <span style="display: inline-block">
                      <span class="text-danger font-weight-bold">*</span>
                      توضیحات:
                    </span>
                  </div>

                  <div class="col-sm-8">
                    <textarea formControlName="comment" fullWidth id="comment" nbInput placeholder="توضیحات"
                      rows="5"></textarea>

                    <div *ngFor="
                        let validation of INPUT_VALIDATION_MESSAGES_EndOrBlockRequest.comment
                      ">
                      <span class="text-danger" *ngIf="
                          formEndOrBlockRequest
                            .get('comment')
                            .hasError(validation.type) &&
                          (formEndOrBlockRequest.get('comment').dirty ||
                            formEndOrBlockRequest.get('comment').touched ||
                            isSubmitedEndOrBlockRequest)
                        ">{{ validation.message }}</span>
                    </div>
                  </div>
                </div>
              </nb-card-body>
            </nb-card>
            <nb-card-footer>
              <div class="row">
                <div class="col-sm-6 pl-1">
                  <button [nbSpinner]="endOrBlockRequestLoading" [disabled]="endOrBlockRequestLoading"
                    nbSpinnerStatus="info" nbSpinnerSize="large" fullWidth nbButton hero status="success" type="submit">
                    غیر فعال سازی
                  </button>
                </div>
                <div class="col-sm-6 pr-1">
                  <button [disabled]="endOrBlockRequestLoading" fullWidth nbButton hero status="danger"
                    (click)="dialogEndOrBlockRef.close()">
                    انصراف
                  </button>
                </div>
              </div>
            </nb-card-footer>
          </form>
        </div>
      </div>
    </nb-card-body>
  </nb-card>
</ng-template>

<ng-template #stopEndOrBlockRequest let-data let-ref="dialogStopEndOrBlockRef">
  <nb-card size="medium" status="success" accent="success">
    <nb-card-header>
      <h6 style="color: linen">فعال سازی پرونده شماره {{ data.fileNumber }}</h6>
    </nb-card-header>
    <nb-card-body>
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12">
          <form [formGroup]="formStopEndOrBlockRequest"
            (ngSubmit)="stopEndOrBlockRequestConfirm(data.endOrBlockRequestId)">
            <nb-card>
              <nb-card-body>
                <div class="row mt-2 mb-3 mb-0">
                  <div class="col-sm-4 mt-2">
                    <span style="display: inline-block">
                      <span class="text-danger font-weight-bold">*</span>
                      توضیحات:
                    </span>
                  </div>

                  <div class="col-sm-8">
                    <textarea formControlName="unCloseComment" fullWidth id="unCloseComment" nbInput
                      placeholder="توضیحات" rows="5"></textarea>

                    <div *ngFor="
                        let validation of INPUT_VALIDATION_MESSAGES_StopEndOrBlockRequest.unCloseComment
                      ">
                      <span class="text-danger" *ngIf="
                          formStopEndOrBlockRequest
                            .get('unCloseComment')
                            .hasError(validation.type) &&
                          (formStopEndOrBlockRequest.get('unCloseComment')
                            .dirty ||
                            formStopEndOrBlockRequest.get('unCloseComment')
                              .touched ||
                            isSubmitedStopEndOrBlockRequest)
                        ">{{ validation.message }}</span>
                    </div>
                  </div>
                </div>
              </nb-card-body>
            </nb-card>

            <nb-card-footer>
              <div class="row">
                <div class="col-sm-6 pl-1">
                  <button [nbSpinner]="stopEndOrBlockRequestLoading" [disabled]="stopEndOrBlockRequestLoading"
                    nbSpinnerStatus="info" nbSpinnerSize="large" fullWidth nbButton hero status="success" type="submit">
                    فعال سازی
                  </button>
                </div>
                <div class="col-sm-6 pr-1">
                  <button [disabled]="stopEndOrBlockRequestLoading" fullWidth nbButton hero status="danger"
                    (click)="dialogStopEndOrBlockRef.close()">
                    انصراف
                  </button>
                </div>
              </div>
            </nb-card-footer>
          </form>
        </div>
      </div>
    </nb-card-body>
  </nb-card>
</ng-template>

<ng-template #suspendRequest let-data let-ref="dialogSuspendRef">
  <nb-card size="medium" status="info" accent="info">
    <nb-card-header>
      <h6 >
        معلق سازی پرونده شماره {{ data.fileNumber }}
      </h6>
    </nb-card-header>
    <nb-card-body>
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12">
          <form [formGroup]="formSuspendRequest" (ngSubmit)="suspendRequestConfirm(data.entityId)">
            <nb-card>
              <nb-card-body>
                <div class="row mt-2 mb-3 mb-0">
                  <div class="col-sm-4 mt-2">
                    <span style="display: inline-block">
                      <span class="text-danger font-weight-bold">*</span>
                      توضیحات:
                    </span>
                  </div>

                  <div class="col-sm-8">
                    <textarea formControlName="comment" fullWidth id="comment" nbInput placeholder="توضیحات"
                      rows="5"></textarea>

                    <div *ngFor="
                        let validation of INPUT_VALIDATION_MESSAGES_SuspendRequest.comment
                      ">
                      <span class="text-danger" *ngIf="
                          formSuspendRequest
                            .get('comment')
                            .hasError(validation.type) &&
                          (formSuspendRequest.get('comment').dirty ||
                            formSuspendRequest.get('comment').touched ||
                            isSubmitedSuspendRequest)
                        ">{{ validation.message }}</span>
                    </div>
                  </div>
                </div>
              </nb-card-body>
              <nb-card-footer>
                <div class="row">
                  <div class="col-sm-6 pl-1">
                    <button [nbSpinner]="suspendRequestLoading" [disabled]="suspendRequestLoading"
                      nbSpinnerStatus="info" nbSpinnerSize="large" fullWidth nbButton hero status="success" type="submit">
                      تعلیق
                    </button>
                  </div>
                  <div class="col-sm-6 pr-1">
                    <button [disabled]="suspendRequestLoading" fullWidth nbButton hero status="danger"
                      (click)="dialogSuspendRef.close()">
                      انصراف
                    </button>
                  </div>
                </div>
              </nb-card-footer>
            </nb-card>
          </form>
        </div>
      </div>
    </nb-card-body>
  </nb-card>
</ng-template>


<ng-template #cancelSuspendedRequest let-data let-ref="dialogCancelSuspendedRef">
  <nb-card size="medium" status="info" accent="info">
    <nb-card-header>
      <h6 >فعال سازی پرونده شماره {{ data.fileNumber }}</h6>
    </nb-card-header>
    <nb-card-body>
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12">
          <form [formGroup]="formCancelSuspendRequest"
            (ngSubmit)="cancelSuspendRequestConfirm(data.suspendRequestId)">
            <nb-card>
              <nb-card-body>
                <div class="row mt-2 mb-3 mb-0">
                  <div class="col-sm-4 mt-2">
                    <span style="display: inline-block">
                      <span class="text-danger font-weight-bold">*</span>
                      توضیحات:
                    </span>
                  </div>

                  <div class="col-sm-8">
                    <textarea formControlName="unCloseComment" fullWidth id="unCloseComment" nbInput
                      placeholder="توضیحات" rows="5"></textarea>

                    <div *ngFor="
                        let validation of INPUT_VALIDATION_MESSAGES_CancelSuspendRequest.unCloseComment
                      ">
                      <span class="text-danger" *ngIf="
                      formCancelSuspendRequest
                            .get('unCloseComment')
                            .hasError(validation.type) &&
                          (formCancelSuspendRequest.get('unCloseComment')
                            .dirty ||
                            formCancelSuspendRequest.get('unCloseComment')
                              .touched ||
                              isSubmitedCancelSuspendRequest)
                        ">{{ validation.message }}</span>
                    </div>
                  </div>
                </div>
              </nb-card-body>
            </nb-card>

            <nb-card-footer>
              <div class="row">
                <div class="col-sm-6 pl-1">
                  <button [nbSpinner]="cancelSuspendedRequestLoading" [disabled]="cancelSuspendedRequestLoading"
                    nbSpinnerStatus="info" nbSpinnerSize="large" fullWidth nbButton hero status="success" type="submit">
 عدم تعلیق
                  </button>
                </div>
                <div class="col-sm-6 pr-1">
                  <button [disabled]="cancelSuspendedRequestLoading" fullWidth nbButton hero status="danger"
                    (click)="dialogCancelSuspendRef.close()">
                    انصراف
                  </button>
                </div>
              </div>
            </nb-card-footer>
          </form>
        </div>
      </div>
    </nb-card-body>
  </nb-card>
</ng-template>